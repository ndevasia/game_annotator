<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Note Annotation</title>
  <!-- Link to external stylesheet -->
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="annotation-ui">
    <textarea id="note" placeholder="Type your annotation..."></textarea>
    <button class = "button-small" onclick="saveNote()">Save</button>
  </div>

  <script>
    const { ipcRenderer } = require('electron');

    function saveNote() {
      const note = document.getElementById('note').value;
      const timestamp = Date.now();
      ipcRenderer.send('save-annotation', { note, timestamp });
      document.getElementById('note').value = '';
      ipcRenderer.send('hide-overlay');
    }

    ipcRenderer.on('emoji-reaction', (event, emoji) => {
      // Hide annotation UI
      const annotationUI = document.getElementById('annotation-ui');
      if (annotationUI) annotationUI.style.display = 'none';

      // Show emoji reaction on overlay
      showEmojiReaction(emoji);
    });
    ipcRenderer.on('show-annotation-ui', () => {
      const annotationUI = document.getElementById('annotation-ui');
      if (annotationUI) annotationUI.style.display = 'flex';
    });


    function showEmojiReaction(emoji) {
      const emojiDiv = document.createElement('div');
      emojiDiv.textContent = emoji;
      emojiDiv.style.position = 'fixed';
      emojiDiv.style.top = '20%';
      emojiDiv.style.left = '50%';
      emojiDiv.style.transform = 'translateX(-50%)';
      emojiDiv.style.fontSize = '5rem';
      emojiDiv.style.opacity = '1';
      emojiDiv.style.transition = 'opacity 1.5s ease-out';
      emojiDiv.style.pointerEvents = 'none';     // Prevent interaction
      emojiDiv.style.background = 'none';        // No background color
      emojiDiv.style.willChange = 'opacity';     // Optimize opacity transition
      emojiDiv.style.userSelect = 'none';        // Prevent text selection

      document.body.appendChild(emojiDiv);

      setTimeout(() => {
        emojiDiv.style.opacity = '0';
      }, 500);

      setTimeout(() => {
        if (emojiDiv.parentNode) {
          emojiDiv.parentNode.removeChild(emojiDiv);
        }
      }, 2000);
    }

  </script>
</body>
</html>
